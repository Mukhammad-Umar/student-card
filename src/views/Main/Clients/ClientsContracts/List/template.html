<b-row class="table-list mb-3">
  <b-col>
    <TableFilters :filterData="filterData" :branches="branches" @emit:search="getClients" />

    <b-card no-body class="card-box-shadow">
      <b-card-header class="align-items-center d-flex flex-wrap justify-content-between">
        <TablePerPage :pagination="filterData.pagination" @emit:update="getClients" />

        <div class="d-flex justify-content-end">
          <ExportBtn
            ref="exportRef"
            :rows="rows" :loadBtn="loadBtn"
            :text="$t('menus.payersContracts')"
            @emit:import="downloadExcel"
          />

          <b-button 
            class="ml-2" variant="info" 
            v-can="['client_contract_add']"
            @click="$router.push({ name: 'MainClientsAdd' })" 
          >
            {{ $t('add') }} <i class="mdi mdi-plus"></i>
          </b-button>
        </div>
      </b-card-header>

      <div class="table-responsive mb-0">
        <b-table :items="rows" :fields="fields" :busy="loading" :show-empty="!loading" hover>
          <template #table-busy>
            <div class="text-center text-primary my-2">
              <b-spinner class="align-middle mr-2"></b-spinner>
              <strong>{{ $t('loading') }}...</strong>
            </div>
          </template>

          <template #empty="scope">
            <h6 class="text-center text-muted py-2 mb-0">{{ $t('error.noData') }}</h6>
          </template>

          <template v-slot:cell(pinfl)="{ item }">
            <router-link
              class="text-primary"
              :to="{
                  name: 'MainClientsContractsView',
                  params: { id: item.organizationDebtorId }
                }"
              >{{ item.pinfl }}
            </router-link>
          </template>

          <template v-slot:cell(actions)="{ item }">
            <i
              class="mdi mdi-arrow-right-circle-outline text-info cup h3"
              @click="
                  $router.push({
                    name: 'MainClientsContractsView',
                    params: { id: item.organizationDebtorId }
                  })
                "
            ></i>
          </template>
        </b-table>
      </div>
    </b-card>

    <TablePagination :pagination="filterData?.pagination" @emit:change="getClients" />
  </b-col>
</b-row>
