<b-row class="table-list mb-3">
  <b-col>
    <TableFilters :filterData="filterData" @emit:search="getList" />

    <b-card no-body class="card-box-shadow">
      <b-card-header class="align-items-center d-flex justify-content-between">
        <TablePerPage :pagination="filterData.pagination" @emit:update="getList" />

        <b-button 
          v-can="['client_white_list_add']" variant="info" 
          class="ms-auto" @click="$router.push({ name: 'MainClientsWhiteAdd' })">
          {{ $t('add') }} <i class="mdi mdi-plus"></i>
        </b-button>
      </b-card-header>

      <div class="table-responsive mb-0">
        <b-table :items="rows" :fields="fields" :busy="loading" :show-empty="!loading" hover>
          <template #table-busy>
            <div class="text-center text-primary my-2">
              <b-spinner class="align-middle mr-2"></b-spinner>
              <strong>{{$t('loading')}}...</strong>
            </div>
          </template>

          <template #empty="scope">
            <h6 class="text-center text-muted py-2 mb-0">{{ $t('error.noData') }}</h6>
          </template>

          <template v-slot:cell(pinfl)="{ item }">
            <router-link
              class="text-primary"
              :to="{
                  name: 'MainClientsContractsView',
                  params: { id: item.organizationDebtorId }
                }"
              >{{ item.pinfl }}
            </router-link>
          </template>

          <template v-slot:cell(actions)="{ item }">
            <i
              v-can="['client_white_list_remove']"
              class="mdi mdi-trash-can-outline text-danger cup h3 mr-1"
              @click="excludeId = item.organizationExcludeDebtorId; modals.modal = true"
            ></i>
            <i
              class="mdi mdi-arrow-right-circle-outline text-info cup h3"
              @click="
                $router.push({
                  name: 'MainClientsContractsView',
                  params: { id: item.organizationDebtorId }
                })
              "
            ></i>
          </template>
        </b-table>
      </div>
    </b-card>

    <TablePagination :pagination="filterData?.pagination" @emit:change="getList" />
  </b-col>

  <MakeSureDialog
    :modals="modals"
    :loading="modalLoading"
    @emit:close="modals.modal = false"
    @emit:success="removePayer"
  >
    {{ $t('dialog.sureDelete') }}
  </MakeSureDialog>
</b-row>
